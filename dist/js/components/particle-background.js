class ParticleBackground{constructor(containerId="particles-js"){this.containerId=containerId;this.config={particles:{number:{value:60,density:{enable:true,value_area:900}},color:{value:"#1a5a96"},shape:{type:"circle",stroke:{width:0,color:"#000000"}},opacity:{value:.5,random:true,anim:{enable:true,speed:.8,opacity_min:.1,sync:false}},size:{value:3,random:true,anim:{enable:true,speed:2,size_min:.1,sync:false}},line_linked:{enable:true,distance:150,color:"#1a5a96",opacity:.3,width:1},move:{enable:true,speed:1,direction:"none",random:true,straight:false,out_mode:"out",bounce:false,attract:{enable:true,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:true,mode:"grab"},onclick:{enable:true,mode:"push"},resize:true},modes:{grab:{distance:180,line_linked:{opacity:.8}},bubble:{distance:400,size:6,duration:2,opacity:.8,speed:3},repulse:{distance:150,duration:.4},push:{particles_nb:4},remove:{particles_nb:2}}},retina_detect:true};this.updateColors();this.init();this.setupThemeListener();this.setupIntelligentBehavior()}init(){if(typeof particlesJS!=="undefined"&&document.getElementById(this.containerId)){particlesJS(this.containerId,this.config)}else{console.warn("particles.js not loaded or container not found")}}updateColors(){const isDarkMode=document.body.classList.contains("dark-mode");if(isDarkMode){this.config.particles.color.value="#2980b9";this.config.particles.line_linked.color="#2980b9"}else{this.config.particles.color.value="#1a5a96";this.config.particles.line_linked.color="#1a5a96"}}setupThemeListener(){window.addEventListener("themechange",()=>{this.updateColors();this.init()});const darkModeToggle=document.getElementById("dark-mode-toggle");if(darkModeToggle){darkModeToggle.addEventListener("click",()=>{setTimeout(()=>{this.updateColors();this.init()},100)})}}setupIntelligentBehavior(){let lastActivity=Date.now();let isIdle=false;const idleThreshold=3e4;const updateActivity=()=>{lastActivity=Date.now();if(isIdle){isIdle=false;this.becomeActive()}};const activityEvents=["mousemove","mousedown","keydown","touchstart","scroll"];activityEvents.forEach(eventType=>{document.addEventListener(eventType,updateActivity)});setInterval(()=>{if(!isIdle&&Date.now()-lastActivity>idleThreshold){isIdle=true;this.becomeIdle()}},5e3);window.addEventListener("scroll",this.throttle(()=>{const scrollY=window.scrollY;const maxScroll=document.body.scrollHeight-window.innerHeight;const scrollPercent=scrollY/maxScroll;if(typeof pJSDom!=="undefined"&&pJSDom.length>0&&pJSDom[0].pJS){const maxParticles=60;const minParticles=20;const newParticleCount=Math.max(minParticles,Math.round(maxParticles-scrollPercent*(maxParticles-minParticles)));if(Math.abs(pJSDom[0].pJS.particles.array.length-newParticleCount)>5){pJSDom[0].pJS.particles.number.value=newParticleCount;pJSDom[0].pJS.fn.particlesRefresh()}}},200));document.addEventListener("click",this.throttle(event=>{if(typeof pJSDom!=="undefined"&&pJSDom.length>0&&pJSDom[0].pJS){const pJS=pJSDom[0].pJS;const targetElement=event.target;const isImportantElement=targetElement.classList.contains("btn")||targetElement.classList.contains("vendor-select-card")||targetElement.closest(".btn")||targetElement.closest(".vendor-select-card");if(isImportantElement){for(let i=0;i<5;i++){if(pJS.particles.array.length<pJS.particles.number.value*1.2){pJS.particles.array.push(new pJS.fn.particle(pJS.particles.color,pJS.particles.opacity.value,{x:event.clientX,y:event.clientY}))}}}}},200))}becomeIdle(){if(typeof pJSDom!=="undefined"&&pJSDom.length>0&&pJSDom[0].pJS){const pJS=pJSDom[0].pJS;pJS.particles.move.speed=.7;pJS.particles.opacity.value=.3;pJS.particles.line_linked.opacity=.2;pJS.fn.particlesRefresh()}}becomeActive(){if(typeof pJSDom!=="undefined"&&pJSDom.length>0&&pJSDom[0].pJS){const pJS=pJSDom[0].pJS;pJS.particles.move.speed=1.5;pJS.particles.opacity.value=.5;pJS.particles.line_linked.opacity=.3;pJS.fn.particlesRefresh()}}throttle(func,limit){let inThrottle;return function(){const args=arguments;const context=this;if(!inThrottle){func.apply(context,args);inThrottle=true;setTimeout(()=>inThrottle=false,limit)}}}}document.addEventListener("DOMContentLoaded",()=>{window.particleBackground=new ParticleBackground});
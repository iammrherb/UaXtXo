class ChartManager{constructor(){this.charts={};this.config=window.TCAConfig||{};this.apexManager=new ApexChartManager;this.highchartsManager=new HighchartsManager;this.d3Manager=new D3Manager;this.initializeChartLibraries()}initializeChartLibraries(){if(window.ApexCharts){window.ApexCharts.defaultOptions={chart:{fontFamily:this.config.charts.defaults.fontFamily,toolbar:this.config.charts.defaults.toolbar,animations:this.config.charts.defaults.animations},colors:this.config.colors.chart,title:{style:{fontSize:this.config.charts.defaults.titleFontSize+"px",fontWeight:600}},tooltip:{style:{fontSize:this.config.charts.defaults.fontSize+"px"}}}}if(window.Highcharts){Highcharts.setOptions({colors:this.config.colors.chart,chart:{style:{fontFamily:this.config.charts.defaults.fontFamily,fontSize:this.config.charts.defaults.fontSize+"px"},animation:this.config.charts.defaults.animations,backgroundColor:null,borderRadius:8,spacing:[20,20,20,20]},title:{style:{fontFamily:this.config.charts.defaults.fontFamily,fontSize:this.config.charts.defaults.titleFontSize+"px",fontWeight:600}},credits:{enabled:false}})}}createChart(library,chartType,elementId,data,options={}){const chartId=options.chartId||elementId;this.destroyChart(chartId);let chart;switch(library.toLowerCase()){case"apex":chart=this.apexManager.createChart(chartType,elementId,data,options);break;case"highcharts":chart=this.highchartsManager.createChart(chartType,elementId,data,options);break;case"d3":chart=this.d3Manager.createChart(chartType,elementId,data,options);break;default:console.error(`Unknown chart library: ${library}`);return null}if(chart){this.charts[chartId]={chart:chart,library:library.toLowerCase(),type:chartType}}return chart}updateChart(chartId,data,options={}){const chartInfo=this.charts[chartId];if(!chartInfo){console.error(`Chart ${chartId} not found`);return null}let chart;switch(chartInfo.library){case"apex":chart=this.apexManager.updateChart(chartInfo.chart,data,options);break;case"highcharts":chart=this.highchartsManager.updateChart(chartInfo.chart,data,options);break;case"d3":chart=this.d3Manager.updateChart(chartInfo.chart,data,options);break;default:console.error(`Unknown chart library: ${chartInfo.library}`);return null}return chart}destroyChart(chartId){const chartInfo=this.charts[chartId];if(!chartInfo)return;switch(chartInfo.library){case"apex":this.apexManager.destroyChart(chartInfo.chart);break;case"highcharts":this.highchartsManager.destroyChart(chartInfo.chart);break;case"d3":this.d3Manager.destroyChart(chartInfo.chart);break;default:console.error(`Unknown chart library: ${chartInfo.library}`);break}delete this.charts[chartId]}destroyAllCharts(){Object.keys(this.charts).forEach(chartId=>{this.destroyChart(chartId)})}initFinancialCharts(data){this.createChart("apex","bar","tco-comparison-chart",data,{chartId:"tcoComparisonChart",title:"3-Year TCO Comparison",xField:"name",yField:"tco",formatter:val=>this.config.formatCurrency(val)});this.createChart("apex","line","cumulative-cost-chart",data,{chartId:"cumulativeCostChart",title:"Cumulative Cost Over Time",xField:"period",yField:"cumulative",formatter:val=>this.config.formatCurrency(val)});this.createChart("apex","stacked-bar","cost-structure-chart",data,{chartId:"costStructureChart",title:"Cost Structure Breakdown",xField:"name",yFields:["hardware","subscription","personnel","implementation","maintenance"],formatter:val=>this.config.formatCurrency(val)});this.createChart("highcharts","column-line","roi-chart",data,{chartId:"roiChart",title:"ROI & Payback Analysis",series:[{type:"column",name:"Investment",data:data.investment},{type:"column",name:"Savings",data:data.savings},{type:"line",name:"Payback Period",data:data.payback,yAxis:1}],formatter:val=>this.config.formatCurrency(val)})}initSecurityCharts(data){this.createChart("d3","treemap","security-capability-chart",data,{chartId:"securityCapabilityChart",title:"Security Capability Comparison",valueField:"score",groupBy:"vendor",colorBy:"category",formatter:val=>val+"%"});this.createChart("apex","horizontal-bar","nist-framework-chart",data,{chartId:"nistFrameworkChart",title:"NIST Cybersecurity Framework Coverage",xField:"category",yField:"coverage",groupBy:"vendor",formatter:val=>val+"%"});this.createChart("highcharts","column-drilldown","breach-impact-chart",data,{chartId:"breachImpactChart",title:"Potential Breach Impact Analysis",series:data.breachImpact.series,drilldown:data.breachImpact.drilldown,formatter:val=>this.config.formatCurrency(val)});this.createChart("d3","heatmap","compliance-coverage-chart",data,{chartId:"complianceCoverageChart",title:"Regulatory Compliance Coverage",xField:"regulation",yField:"vendor",valueField:"coverage",formatter:val=>val+"%"})}initTechnicalCharts(data){this.createChart("apex","column","architecture-chart",data,{chartId:"architectureChart",title:"Architecture Comparison",xField:"architecture",yField:"count",formatter:val=>val});this.createChart("d3","heatmap","feature-comparison-chart",data,{chartId:"featureComparisonChart",title:"Feature Comparison",xField:"feature",yField:"vendor",valueField:"supported",formatter:val=>val?"Yes":"No"});this.createChart("apex","horizontal-bar","deployment-time-chart",data,{chartId:"deploymentTimeChart",title:"Average Deployment Time",xField:"vendor",yField:"deploymentDays",formatter:val=>val+" days"});this.createChart("d3","network","integration-capabilities-chart",data,{chartId:"integrationCapabilitiesChart",title:"Integration Capabilities",nodes:data.integrations.nodes,links:data.integrations.links})}initExecutiveCharts(data){this.createChart("apex","radar","executive-summary-chart",data,{chartId:"executiveSummaryChart",title:"Solution Comparison",categories:["TCO","Security","Features","Deployment","Support"],series:data.executiveSummary});this.createChart("highcharts","bubble","business-impact-chart",data,{chartId:"businessImpactChart",title:"Business Impact Analysis",series:data.businessImpact});this.createChart("apex","horizontal-bar","value-drivers-chart",data,{chartId:"valueDriversChart",title:"Value Drivers",xField:"driver",yField:"value",groupBy:"vendor",formatter:val=>val+"%"});this.createChart("apex","pie","roi-summary-chart",data,{chartId:"roiSummaryChart",title:"ROI Components",labels:data.roiSummary.labels,series:data.roiSummary.values,formatter:val=>this.config.formatCurrency(val)})}}class ApexChartManager{createChart(chartType,elementId,data,options){const element=document.getElementById(elementId);if(!element){console.error(`Element ${elementId} not found`);return null}element.innerHTML="";let chartOptions;switch(chartType){case"bar":chartOptions=this.createBarChartOptions(data,options);break;case"line":chartOptions=this.createLineChartOptions(data,options);break;case"stacked-bar":chartOptions=this.createStackedBarChartOptions(data,options);break;case"horizontal-bar":chartOptions=this.createHorizontalBarChartOptions(data,options);break;case"pie":chartOptions=this.createPieChartOptions(data,options);break;case"radar":chartOptions=this.createRadarChartOptions(data,options);break;default:console.error(`Unknown ApexCharts chart type: ${chartType}`);return null}if(options.title){chartOptions.title={text:options.title,align:"center",margin:15}}const chart=new ApexCharts(element,chartOptions);chart.render();return chart}updateChart(chart,data,options){chart.updateSeries(data.series||data);if(options&&Object.keys(options).length>0){chart.updateOptions(options)}return chart}destroyChart(chart){if(chart&&typeof chart.destroy==="function"){chart.destroy()}}createBarChartOptions(data,options){return{chart:{type:"bar",height:350},plotOptions:{bar:{horizontal:false,columnWidth:"55%",borderRadius:8}},series:[{name:options.yField||"Value",data:data}]}}createLineChartOptions(data,options){return{}}createStackedBarChartOptions(data,options){return{}}createHorizontalBarChartOptions(data,options){return{}}createPieChartOptions(data,options){return{}}createRadarChartOptions(data,options){return{}}}class HighchartsManager{createChart(chartType,elementId,data,options){const element=document.getElementById(elementId);if(!element){console.error(`Element ${elementId} not found`);return null}let chartOptions;switch(chartType){case"column-line":chartOptions=this.createColumnLineChartOptions(data,options);break;case"column-drilldown":chartOptions=this.createColumnDrilldownChartOptions(data,options);break;case"bubble":chartOptions=this.createBubbleChartOptions(data,options);break;default:console.error(`Unknown Highcharts chart type: ${chartType}`);return null}if(options.title){chartOptions.title={text:options.title}}const chart=Highcharts.chart(element,chartOptions);return chart}updateChart(chart,data,options){if(data&&data.series){data.series.forEach((series,i)=>{if(chart.series[i]){chart.series[i].setData(series.data,false)}})}if(options){}chart.redraw();return chart}destroyChart(chart){if(chart&&typeof chart.destroy==="function"){chart.destroy()}}createColumnLineChartOptions(data,options){return{}}createColumnDrilldownChartOptions(data,options){return{}}createBubbleChartOptions(data,options){return{}}}class D3Manager{createChart(chartType,elementId,data,options){const element=document.getElementById(elementId);if(!element){console.error(`Element ${elementId} not found`);return null}element.innerHTML="";let chart;switch(chartType){case"treemap":chart=this.createTreemap(element,data,options);break;case"heatmap":chart=this.createHeatmap(element,data,options);break;case"network":chart=this.createNetworkGraph(element,data,options);break;default:console.error(`Unknown D3 chart type: ${chartType}`);return null}if(options.title){const title=document.createElement("h3");title.className="chart-title";title.textContent=options.title;element.insertBefore(title,element.firstChild)}return chart}updateChart(chart,data,options){return chart}destroyChart(chart){if(chart&&chart.container){d3.select(chart.container).selectAll("*").remove()}}createTreemap(container,data,options){return{}}createHeatmap(container,data,options){return{}}createNetworkGraph(container,data,options){return{}}}document.addEventListener("DOMContentLoaded",function(){window.chartManager=new ChartManager});
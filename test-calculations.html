<!DOCTYPE html>
<html>
<head>
    <title>TCO Calculation Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .result { margin: 10px 0; padding: 10px; background: #f0f0f0; border-radius: 5px; }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
    </style>
</head>
<body>
    <h1>TCO Calculation Test</h1>
    <div id="results"></div>
    
    <!-- Load all required scripts -->
    <script src="./js/enhancements/comprehensive-data-enhancement.js"></script>
    <script src="./js/data/comprehensive-vendor-data.js"></script>
    <script src="./js/data/enhanced-vendor-calculations.js"></script>
    
    <script>
        setTimeout(() => {
            const results = document.getElementById('results');
            
            // Test 1: Check if vendor calculator exists
            if (window.EnhancedVendorCalculator) {
                results.innerHTML += '<div class="result success">✅ EnhancedVendorCalculator found</div>';
                
                // Create instance
                const calc = new window.EnhancedVendorCalculator();
                results.innerHTML += '<div class="result success">✅ Calculator instance created</div>';
                
                // Test calculation
                const testConfig = {
                    deviceCount: 1000,
                    locationCount: 3,
                    companySize: 'medium',
                    analysisPeriod: 3,
                    fteCost: 100000,
                    breachCost: 4350000
                };
                
                try {
                    const vendorData = calc.generateVendorComparison(testConfig);
                    results.innerHTML += '<div class="result success">✅ Vendor comparison generated</div>';
                    
                    // Check Portnox
                    if (vendorData.portnox) {
                        const portnoxTCO = vendorData.portnox.tco?.tco || 0;
                        results.innerHTML += `<div class="result success">✅ Portnox TCO: $${(portnoxTCO / 1000).toFixed(0)}K</div>`;
                    } else {
                        results.innerHTML += '<div class="result error">❌ No Portnox data</div>';
                    }
                    
                    // Show all vendors
                    Object.keys(vendorData).forEach(vendor => {
                        const tco = vendorData[vendor].tco?.tco || 0;
                        results.innerHTML += `<div class="result">${vendorData[vendor].name}: $${(tco / 1000).toFixed(0)}K</div>`;
                    });
                    
                } catch (error) {
                    results.innerHTML += `<div class="result error">❌ Error: ${error.message}</div>`;
                }
            } else {
                results.innerHTML += '<div class="result error">❌ EnhancedVendorCalculator not found</div>';
            }
        }, 1000);
    </script>
</body>
</html>
